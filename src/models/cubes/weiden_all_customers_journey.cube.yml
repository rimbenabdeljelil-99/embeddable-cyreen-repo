cubes :

  - name: weiden_all_customers_journey
    title: Weiden All Customers Journey
    sql: >
      SELECT
        data_day,
        customer_journey_number,
        EXTRACT(EPOCH FROM (MAX(timestamp) - MIN(timestamp))) AS duration
      FROM vw_weiden_all_customer_journeys_30
      GROUP BY data_day, customer_journey_number

    data_source: my-db2
    
    dimensions:
      - name: id_temp_1_tag_event
        sql: id_temp_1_tag_event
        type: number
      
      - name: id_store
        sql: id_store
        type: number

      - name: id_area_reader
        sql: id_area_reader
        type: number

      - name: number_tag
        sql: number_tag
        type: number

      - name: timestamp
        sql: timestamp
        type: time

      - name: data_day
        sql: data_day
        type: time

      - name: week
        type: number
        sql: "EXTRACT(WEEK FROM data_day)"

      - name: duration
        sql: duration
        type: number


      - name: customer_journey_number
        sql: customer_journey_number
        type: number


    measures:

     - name: average_duration
       type: avg
       sql: duration / 60.0
       title: "Journey Duration (minutes)"


     - name: average_duration_round
       type: avg
       sql: duration
       title: "Journey Duration (seconds)"

